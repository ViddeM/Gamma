<script>
    function reindexTypes() {
        update('select');
    }

    function update(n) {
        const inputFields = document.querySelectorAll(n);
        inputFields.forEach(function(input, index) {
            input.name =  'superGroupTypesForInfo[' + index + ']';
            input.id = 'superGroupTypesForInfo' + index;
        });
    }

    document.body.addEventListener("htmx:afterSwap", reindexTypes);
</script>
<style>
    main {
        margin-left: auto;
        margin-right: auto;
        width: fit-content;

        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
</style>
<header th:replace="~{common/header}"></header>
<main>
    <a href="/" >Back</a>
    <h1>Settings</h1>
    <form th:object="${form}" th:action="@{/settings}" th:method="put">
        <div class="super-group-type" th:each="type : ${form.superGroupTypesForInfo}">
            <select>
                <option disabled selected th:value="${type}" th:text="${type}"></option>
            </select>
            <button type="button" _="on click remove closest .super-group-type then call reindexTypes()">Remove</button>
        </div>
        <button type="button" data-hx-get="/settings/new-super-group" data-hx-target="this" data-hx-swap="beforebegin">Add super group type</button>
        <button type="submit">Save</button>
    </form>
</main>